<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Document Verification</title>
  <style>
    /* Your existing CSS styles */
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 20px;
    }
    #initial-image {
      margin-bottom: 20px;
    }
    #input-section {
      margin-bottom: 20px;
    }
    #result {
      margin-top: 20px;
    }
    .verified {
      color: green;
      font-weight: bold;
      font-size: 24px;
    }
    .not-found {
      color: red;
      font-weight: bold;
      font-size: 24px;
    }
    .back-button {
      margin-top: 20px;
    }
    #green-check-image {
      margin-top: 20px;
      margin-bottom: 20px;
    }
    #description {
      margin-top: 10px;
      font-size: 18px;
    }
    input[type="text"] {
      padding: 8px;
      width: 200px;
    }
    button {
      padding: 8px 16px;
    }
  </style>
</head>
<body>
  <!-- Initial Image -->
  <div id="initial-image">
    <img src="https://i.imgur.com/PQXAJeh.png" alt="Initial Image" />
  </div>

  <h2>Document Verification</h2>

  <!-- Input Section -->
  <div id="input-section">
    <input type="text" id="doc-number" placeholder="Enter Document Number">
    <button id="validate-button">Validate</button>
  </div>

  <!-- Green Check Image (Hidden Initially) -->
  <div id="green-check-image" style="display:none;">
    <img src="https://i.imgur.com/QxQGCHZ.png" alt="Green Check" style="width:50px;height:50px;" />
  </div>

  <!-- Result Section -->
  <div id="result"></div>

  <!-- Back Button (Hidden Initially) -->
  <button class="back-button" style="display:none;">Back</button>

  <!-- Place your script here -->
  <script>
    const apiUrl = 'https://tantra-ph.com/PNPKI.php'; // Your server.php URL

    // Define functions in the global scope
    function validateDocument() {
      const docNumberElement = document.getElementById('doc-number');
      const docNumber = docNumberElement.value.trim();
      if (docNumber === '') {
        alert('Please enter a Document Number.');
        return;
      }

      // Hide the initial image
      document.getElementById('initial-image').style.display = 'none';

      // Disable input and button to prevent multiple submissions
      docNumberElement.disabled = true;
      document.getElementById('validate-button').disabled = true;

      // Show loading indicator (optional)
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = 'Loading...';

      // Make an AJAX POST request to server.php
      fetch(apiUrl, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ docNumber: docNumber })
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json();
      })
      .then(data => {
        displayResult(data);
      })
      .catch(error => {
        console.error('Error:', error);
        alert('An error occurred while processing your request.');
        goBack(); // Reset the form
      });
    }

    function displayResult(result) {
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = ''; // Clear previous results

      if (result.found) {
        // Show the green check image
        document.getElementById('green-check-image').style.display = 'block';

        // Display "Verified!" message
        const verifiedDiv = document.createElement('div');
        verifiedDiv.className = 'verified';
        verifiedDiv.innerHTML = 'Verified!';
        resultDiv.appendChild(verifiedDiv);

        // Display the document description
        const descriptionDiv = document.createElement('div');
        descriptionDiv.id = 'description';
        descriptionDiv.textContent = result.description;
        resultDiv.appendChild(descriptionDiv);
      } else {
        // Display "Document Not Found!" message
        const notFoundDiv = document.createElement('div');
        notFoundDiv.className = 'not-found';
        notFoundDiv.textContent = 'Document Not Found!';
        resultDiv.appendChild(notFoundDiv);
      }

      // Show back button
      document.querySelector('.back-button').style.display = 'inline-block';
      // Hide input section
      document.getElementById('input-section').style.display = 'none';
    }

    function goBack() {
      // Reset input
      const docNumberElement = document.getElementById('doc-number');
      docNumberElement.value = '';
      docNumberElement.disabled = false;
      document.getElementById('validate-button').disabled = false;

      // Hide result and back button
      document.getElementById('result').innerHTML = '';
      document.querySelector('.back-button').style.display = 'none';

      // Show input section
      document.getElementById('input-section').style.display = 'block';

      // Show initial image
      document.getElementById('initial-image').style.display = 'block';

      // Hide the green check image
      document.getElementById('green-check-image').style.display = 'none';
    }

    // Add event listeners after the functions are defined
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('validate-button').addEventListener('click', validateDocument);
      document.querySelector('.back-button').addEventListener('click', goBack);
    });
  </script>
</body>
</html>
